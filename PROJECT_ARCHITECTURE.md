# ğŸ“Š PROJECT ARCHITECTURE - Cruise Ship Hospitality CMS

## ğŸ›ï¸ Architettura Sistema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CLIENT LAYER                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                    â”‚                    â”‚
     [Web Browser]          [Mobile]           [IPTV/Kiosk]
     React App (IT/EN)      PWA/APK           Touch Screen
           â”‚                    â”‚                    â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                         HTTPS/REST
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              APPLICATION LAYER (Backend)              â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         FastAPI Server (Python)            â”‚  â”‚
â”‚  â”‚                                              â”‚  â”‚
â”‚  â”‚  â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®  â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®  â”‚  â”‚
â”‚  â”‚  â”‚  REST API    â”‚  â”‚ AI Service â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  /api/*      â”‚  â”‚ GPT-5.2    â”‚  â”‚  â”‚
â”‚  â”‚  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯  â”‚  â”‚
â”‚  â”‚                                              â”‚  â”‚
â”‚  â”‚  â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®  â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®  â”‚  â”‚
â”‚  â”‚  â”‚ QR Generatorâ”‚  â”‚ Booking   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ Service     â”‚  â”‚ System    â”‚  â”‚  â”‚
â”‚  â”‚  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                      â”‚                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                    Motor/Async
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 DATA LAYER                           â”‚
â”‚                                                          â”‚
â”‚              MongoDB (NoSQL Database)                  â”‚
â”‚                                                          â”‚
â”‚  Collections:                                          â”‚
â”‚  â€¢ restaurants    â”‚  â€¢ excursions                     â”‚
â”‚  â€¢ entertainment  â”‚  â€¢ bookings                       â”‚
â”‚  â€¢ packages       â”‚  â€¢ services                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           EXTERNAL SERVICES                         â”‚
â”‚                                                          â”‚
â”‚  â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®                                  â”‚
â”‚  â”‚  OpenAI GPT-5.2  â”‚  â† Emergent LLM Key          â”‚
â”‚  â”‚  (via Emergent)  â”‚                                  â”‚
â”‚  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ User Flow Diagrams

### Flow 1: Guest Booking Excursion

```
  â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  Guest  â”‚
  â•°â”€â”€â”€â”¬â”€â”€â”€â”€â”€â•¯
      â”‚
      â”‚ 1. Access Homepage
      â”‚
      â†“
  â•­â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  Navigate to     â”‚
  â”‚  Excursions      â”‚
  â•°â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
      â”‚
      â”‚ 2. Browse Available Tours
      â”‚
      â†“
  â•­â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  Select Tour     â”‚
  â”‚  Click "Book"    â”‚
  â•°â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
      â”‚
      â”‚ 3. Modal Opens
      â”‚
      â†“
  â•­â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  Fill Form:       â”‚
  â”‚  - Name           â”‚
  â”‚  - Email          â”‚
  â”‚  - Date           â”‚
  â”‚  - # Guests       â”‚
  â•°â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
      â”‚
      â”‚ 4. Submit
      â”‚
      â†“
  â•­â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  POST /api/      â”‚
  â”‚  bookings        â”‚
  â•°â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
      â”‚
      â”‚ 5. Save to MongoDB
      â”‚
      â†“
  â•­â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  Success Toast    â”‚
  â”‚  "Booking         â”‚
  â”‚  Confirmed!"      â”‚
  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

### Flow 2: Using AI Chatbot

```
  â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  Guest  â”‚
  â•°â”€â”€â”€â”¬â”€â”€â”€â”€â”€â•¯
      â”‚
      â”‚ 1. Click Chat FAB
      â”‚
      â†“
  â•­â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  Chat Window     â”‚
  â”‚  Opens           â”‚
  â•°â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
      â”‚
      â”‚ 2. Welcome Message
      â”‚ "How can I help?"
      â”‚
      â†“
  â•­â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  User Types:      â”‚
  â”‚  "Restaurant      â”‚
  â”‚  hours?"          â”‚
  â•°â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
      â”‚
      â”‚ 3. Send Message
      â”‚
      â†“
  â•­â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  POST /api/chat   â”‚
  â”‚  {message, sid}   â”‚
  â•°â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
      â”‚
      â”‚ 4. LlmChat() â†’ GPT-5.2
      â”‚ via Emergent Key
      â”‚
      â†“
  â•­â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  AI Response:     â”‚
  â”‚  "Ocean Blue:      â”‚
  â”‚  18:00-23:00..."  â”‚
  â•°â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
      â”‚
      â”‚ 5. Display in Chat
      â”‚
      â†“
  â•­â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  Continue         â”‚
  â”‚  Conversation     â”‚
  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

### Flow 3: QR Code Menu Access

```
  â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  Guest  â”‚
  â•°â”€â”€â”€â”¬â”€â”€â”€â”€â”€â•¯
      â”‚
      â”‚ 1. See QR Code
      â”‚ (Physical/Screen)
      â”‚
      â†“
  â•­â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  Scan with       â”‚
  â”‚  Smartphone      â”‚
  â•°â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
      â”‚
      â”‚ 2. GET /menu/:id
      â”‚
      â†“
  â•­â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  Fetch Restaurant â”‚
  â”‚  & Menu Data      â”‚
  â•°â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
      â”‚
      â”‚ 3. Render Menu
      â”‚
      â†“
  â•­â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  Display:         â”‚
  â”‚  - Categories     â”‚
  â”‚  - Items          â”‚
  â”‚  - Prices         â”‚
  â”‚  - Allergens      â”‚
  â•°â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
      â”‚
      â”‚ 4. Switch Language
      â”‚ (IT â†” EN)
      â”‚
      â†“
  â•­â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚  Translated Menu  â”‚
  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

---

## ğŸ“Š Data Model

### Restaurant Schema
```javascript
{
  id: String (UUID),
  name: String,
  type: String, // "Seafood Fine Dining"
  description: String,
  hours: String, // "18:00 - 23:00"
  image_url: String,
  menu: [
    {
      id: String,
      name: String,
      description: String,
      price: Float,
      category: String, // "Antipasti", "Primi"
      allergens: [String]
    }
  ]
}
```

### Excursion Schema
```javascript
{
  id: String,
  name: String,
  description: String,
  duration: String, // "4 ore"
  price: Float,
  image_url: String,
  available_dates: [String] // ISO dates
}
```

### Booking Schema
```javascript
{
  id: String,
  excursion_id: String,
  guest_name: String,
  guest_email: String,
  date: String,
  num_guests: Int,
  created_at: DateTime
}
```

---

## ğŸŒ API Endpoints Map

```
/api/
â”œâ”€â”€ GET     /                    # Health check
â”œâ”€â”€ POST    /init-data           # Initialize sample data
â”œâ”€â”€â”€ /restaurants
â”‚   â”œâ”€â”€ GET  /                  # List all restaurants
â”‚   â””â”€â”€ GET  /:id               # Get restaurant by ID
â”œâ”€â”€â”€ /excursions
â”‚   â””â”€â”€ GET  /                  # List all excursions
â”œâ”€â”€â”€ /bookings
â”‚   â”œâ”€â”€ POST /                  # Create booking
â”‚   â””â”€â”€ GET  /                  # List all bookings
â”œâ”€â”€â”€ /entertainment
â”‚   â””â”€â”€ GET  /                  # List events
â”œâ”€â”€â”€ /packages
â”‚   â””â”€â”€ GET  /                  # List internet packages
â”œâ”€â”€â”€ /services
â”‚   â””â”€â”€ GET  /                  # List guest services
â”œâ”€â”€â”€ POST    /chat                # AI chatbot
â””â”€â”€â”€ GET     /qrcode/:restaurant_id # Generate QR code
```

---

## ğŸ“¦ Component Hierarchy

```
App
â”œâ”€â”€ LanguageProvider
â”‚   â””â”€â”€ LanguageContext
â”œâ”€â”€ BrowserRouter
    â”œâ”€â”€ Routes
    â”‚   â”œâ”€â”€ Home
    â”‚   â”‚   â”œâ”€â”€ LanguageSwitcher
    â”‚   â”‚   â”œâ”€â”€ QuickLinks
    â”‚   â”‚   â””â”€â”€ Footer
    â”‚   â”œâ”€â”€ Restaurants
    â”‚   â”‚   â”œâ”€â”€ RestaurantCard[]
    â”‚   â”‚   â””â”€â”€ Footer
    â”‚   â”œâ”€â”€ MenuPage
    â”‚   â”‚   â”œâ”€â”€ MenuCategory[]
    â”‚   â”‚   â”œâ”€â”€ MenuItem[]
    â”‚   â”‚   â””â”€â”€ QRCode (conditional)
    â”‚   â”œâ”€â”€ Excursions
    â”‚   â”‚   â”œâ”€â”€ ExcursionCard[]
    â”‚   â”‚   â””â”€â”€ BookingDialog
    â”‚   â”œâ”€â”€ Entertainment
    â”‚   â”œâ”€â”€ Services
    â”‚   â”œâ”€â”€ InternetPackages
    â”‚   â”œâ”€â”€ KioskMode
    â”‚   â””â”€â”€ AdminDashboard
    â”œâ”€â”€ Navigation (Global)
    â”œâ”€â”€ ChatBot (Global)
    â””â”€â”€ Toaster (Global)
```

---

## ğŸ” Security Architecture

```
  CLIENT
    â”‚
    â”‚ HTTPS/TLS
    â”‚
    â†“
  â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚ CORS Middleware  â”‚
  â”‚ Input Validation â”‚
  â•°â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â•¯
        â”‚
        â†“
  â•­â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚ Pydantic Models   â”‚
  â”‚ Schema Validation â”‚
  â•°â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
        â”‚
        â†“
  â•­â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚ Business Logic    â”‚
  â”‚ ObjectId Excluded â”‚
  â•°â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
        â”‚
        â†“
  â•­â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  â”‚ Environment Keys â”‚
  â”‚ No hardcoding    â”‚
  â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

---

## ğŸ› ï¸ Technology Stack Detail

### Frontend Stack
```
React 19
  â”œâ”€â”€ React Router 7.11      (Navigation)
  â”œâ”€â”€ Tailwind CSS 3.4       (Styling)
  â”œâ”€â”€ Framer Motion 12       (Animations)
  â”œâ”€â”€ Shadcn/UI              (Components)
  â”œâ”€â”€ Axios 1.13             (HTTP Client)
  â”œâ”€â”€ React QR Code          (QR Generation)
  â”œâ”€â”€ Sonner                 (Toast Notifications)
  â””â”€â”€ Lucide React           (Icons)
```

### Backend Stack
```
FastAPI
  â”œâ”€â”€ Motor 3.3              (Async MongoDB)
  â”œâ”€â”€ Pydantic 2.12          (Validation)
  â”œâ”€â”€ Emergent Integrations  (LLM Unified API)
  â”œâ”€â”€ QRCode 8.2             (QR Generation)
  â”œâ”€â”€ Python-dotenv          (Environment)
  â””â”€â”€ Uvicorn                (ASGI Server)
```

---

**Created by: Carmine D'Alise**
**Repository: https://github.com/iacreatorcar/cruise-hospitality-cms**